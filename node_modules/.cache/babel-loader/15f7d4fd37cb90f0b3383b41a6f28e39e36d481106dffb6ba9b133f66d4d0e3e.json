{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport util from \"@/components/customer/util\";\nimport product_data from \"@/components/customer/product\";\nimport Vue from \"vue\";\nimport Vuex from 'vuex';\n\n//1.安装插件\nVue.use(Vuex);\nconst store = new Vuex.Store({\n  state: {\n    //商品列表信息\n    productList: [],\n    //购物车数据，数组形式，数据元素为对象（商品id，购买数量count）\n    cartList: [],\n    //当前用户账号\n    username: window.localStorage.getItem('username'),\n    //登录状态\n    loginStatus: !!window.localStorage.getItem('loginStatus')\n  },\n  getters: {\n    //品牌、颜色筛选\n    brands: state => {\n      const brands = state.productList.map(item => item.brand);\n      return util.getFilterArray(brands);\n    },\n    colors: state => {\n      const colors = state.productList.map(item => item.color);\n      return util.getFilterArray(colors);\n    }\n  },\n  //mutations只能以同步方式\n  mutations: {\n    //添加商品列表\n    setProductList(state, data) {\n      state.productList = data;\n    },\n    //添加购物车\n    addCart(state, id) {\n      const isAdded = state.cartList.find(item => item.id === id);\n      //如果不存在设置购物车为1，存在count++\n      if (isAdded) {\n        isAdded.count++;\n      } else {\n        state.cartList.push({\n          id: id,\n          count: 1\n        });\n      }\n    },\n    //修改购物车商品数量\n    editCartCount(state, payload) {\n      const product = state.cartList.find(item => item.id === payload.id);\n      product.count += payload.count;\n    },\n    //删除购物车商品\n    deleteCart(state, id) {\n      const index = state.cartList.findIndex(item => item.id === id);\n      state.cartList.splice(index, 1);\n    },\n    //清空购物车\n    emptyCart(state) {\n      state.cartList = [];\n    },\n    getUser(state, username) {\n      console.log('username', username);\n      state.username = username;\n    },\n    getLoginStatus(state, flag) {\n      state.loginStatus = flag;\n    }\n  },\n  actions: {\n    //异步请求商品列表，暂且使用setTimeout\n    getProductList(context) {\n      setTimeout(() => {\n        context.commit('setProductList', product_data);\n      }, 500);\n    },\n    //购买\n    buy(context) {\n      //生产环境使用ajax请求服务端响应后再清空购物车\n      return new Promise(resolve => {\n        setTimeout(() => {\n          context.commit('emptyCart');\n          resolve();\n        }, 500);\n      });\n    }\n  }\n});\nexport default store;","map":{"version":3,"names":["util","product_data","Vue","Vuex","use","store","Store","state","productList","cartList","username","window","localStorage","getItem","loginStatus","getters","brands","map","item","brand","getFilterArray","colors","color","mutations","setProductList","data","addCart","id","isAdded","find","count","push","editCartCount","payload","product","deleteCart","index","findIndex","splice","emptyCart","getUser","console","log","getLoginStatus","flag","actions","getProductList","context","setTimeout","commit","buy","Promise","resolve"],"sources":["E:/数据库大作业/shop/src/components/customer/store/index.js"],"sourcesContent":["import util from \"@/components/customer/util\";\r\nimport product_data from \"@/components/customer/product\";\r\nimport Vue from \"vue\"\r\nimport Vuex from 'vuex'\r\n\r\n//1.安装插件\r\nVue.use(Vuex)\r\nconst store = new Vuex.Store({\r\n    state: {\r\n        //商品列表信息\r\n        productList: [],\r\n        //购物车数据，数组形式，数据元素为对象（商品id，购买数量count）\r\n        cartList: [],\r\n        //当前用户账号\r\n        username: window.localStorage.getItem('username'),\r\n        //登录状态\r\n        loginStatus: !!window.localStorage.getItem('loginStatus'),\r\n    },\r\n    getters: {\r\n        //品牌、颜色筛选\r\n        brands: state => {\r\n            const brands = state.productList.map(item => item.brand);\r\n            return util.getFilterArray(brands);\r\n        },\r\n        colors: state => {\r\n            const colors = state.productList.map(item => item.color);\r\n            return util.getFilterArray(colors);\r\n        }\r\n    },\r\n    //mutations只能以同步方式\r\n    mutations: {\r\n        //添加商品列表\r\n        setProductList(state, data){\r\n            state.productList = data;\r\n        },\r\n        //添加购物车\r\n        addCart(state, id){\r\n            const isAdded = state.cartList.find(item => item.id === id);\r\n            //如果不存在设置购物车为1，存在count++\r\n            if(isAdded){\r\n                isAdded.count++;\r\n            }else{\r\n                state.cartList.push({\r\n                    id: id,\r\n                    count: 1\r\n                })\r\n            }\r\n        },\r\n        //修改购物车商品数量\r\n        editCartCount(state, payload){\r\n            const product = state.cartList.find(item => item.id === payload.id);\r\n            product.count += payload.count;\r\n        },\r\n        //删除购物车商品\r\n        deleteCart(state, id){\r\n            const index = state.cartList.findIndex(item => item.id === id);\r\n            state.cartList.splice(index, 1)\r\n        },\r\n        //清空购物车\r\n        emptyCart(state){\r\n            state.cartList = [];\r\n        },\r\n        getUser(state, username){\r\n            console.log('username',username)\r\n            state.username = username;\r\n        },\r\n        getLoginStatus(state, flag){\r\n            state.loginStatus = flag;\r\n        }\r\n    },\r\n    actions: {\r\n        //异步请求商品列表，暂且使用setTimeout\r\n        getProductList(context){\r\n            setTimeout(() => {\r\n                context.commit('setProductList', product_data)\r\n            }, 500);\r\n        },\r\n        //购买\r\n        buy(context){\r\n            //生产环境使用ajax请求服务端响应后再清空购物车\r\n            return new Promise(resolve => {\r\n                setTimeout(() => {\r\n                    context.commit('emptyCart');\r\n                    resolve();\r\n                }, 500);\r\n            });\r\n        },\r\n    }\r\n});\r\nexport default store"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}