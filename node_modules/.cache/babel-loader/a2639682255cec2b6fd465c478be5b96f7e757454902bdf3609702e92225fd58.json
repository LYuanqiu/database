{"ast":null,"code":"import product_data from './product';\nexport default {\n  name: \"customer_cart\",\n  data() {\n    return {\n      promotion: 0,\n      promotionCode: '',\n      productList: product_data\n    };\n  },\n  computed: {\n    //购物车数据\n    cartList() {\n      return this.$store.state.cartList;\n    },\n    //设置字典对象，方便查询\n    productDictList() {\n      const dict = {};\n      this.productList.forEach(item => {\n        dict[item.id] = item;\n      });\n      return dict;\n    },\n    //购物车商品总数\n    countAll() {\n      let count = 0;\n      this.cartList.forEach(item => {\n        count += item.count;\n      });\n      return count;\n    },\n    //购物车商品总价\n    costAll() {\n      let cost = 0;\n      this.cartList.forEach(item => {\n        cost += this.productDictList[item.id].cost * item.count;\n      });\n      return cost;\n    }\n  },\n  methods: {\n    //通知Vuex,完成下单\n    handleOrder() {\n      this.$store.dispatch('buy').then(() => {\n        window.alert('购买成功');\n      });\n    },\n    //验证优惠码，使用ccylovehs代替优惠券字符串\n    handleCheckCode() {\n      if (this.promotionCode === '') {\n        window.alert('请输入优惠码');\n        return;\n      }\n      if (this.promotionCode !== 'ccylovehs') {\n        window.alert('优惠码输入错误');\n        return;\n      }\n      this.promotion = 500;\n    },\n    //修改购物车数量\n    handleCount(index, count) {\n      //最小值设置1\n      if (count < 0 && this.cartList[index].count === 1) return;\n      this.$store.commit('editCartCount', {\n        id: this.cartList[index].id,\n        count: count\n      });\n    },\n    //根据index查找商品id进行删除\n    handleDelete(index) {\n      this.$store.commit('deleteCart', this.cartList[index].id);\n    }\n  }\n};","map":{"version":3,"mappings":"AAiEA;AACA;EACAA;EACAC;IACA;MACAC;MACAC;MACAC;IACA;EACA;EACAC;IACA;IACAC;MACA;IACA;IACA;IACAC;MACA;MACA;QACAC;MACA;MACA;IACA;IACA;IACAC;MACA;MACA;QACAC;MACA;MACA;IACA;IACA;IACAC;MACA;MACA;QACAC;MACA;MACA;IACA;EACA;EACAC;IACA;IACAC;MACA;QACAC;MACA;IACA;IACA;IACAC;MACA;QACAD;QACA;MACA;MACA;QACAA;QACA;MACA;MACA;IACA;IACA;IACAE;MACA;MACA;MACA;QACAC;QACAR;MACA;IACA;IACA;IACAS;MACA;IACA;EACA;AACA","names":["name","data","promotion","promotionCode","productList","computed","cartList","productDictList","dict","countAll","count","costAll","cost","methods","handleOrder","window","handleCheckCode","handleCount","id","handleDelete"],"sourceRoot":"src/components/customer","sources":["customer_cart.vue"],"sourcesContent":["<template>\r\n    <div class=\"cart\">\r\n        <div class=\"cart-header\">\r\n            <div class=\"cart-header-title\">购物清单</div>\r\n            <div class=\"cart-header-main\">\r\n                <div class=\"cart-info\">商品信息</div>\r\n                <div class=\"cart-price\">单价</div>\r\n                <div class=\"cart-count\">数量</div>\r\n                <div class=\"cart-cost\">小计</div>\r\n                <div class=\"cart-delete\">删除</div>\r\n            </div>\r\n        </div>\r\n        <div class=\"cart-content\">\r\n            <!-- 列表显示购物清单 -->\r\n            <div class=\"cart-content-main\" v-for=\"(item, index)\" :key=\"item\" in cartList\">\r\n                <div class=\"cart-info\">\r\n                    <img :src=\"productDictList[item.id].image\">\r\n                    <span>{{productDictList[item.id].name}}</span>\r\n                </div>\r\n                <div class=\"cart-price\">\r\n                    ￥ {{productDictList[item.id].cost}}\r\n                </div>\r\n                <div class=\"cart-count\">\r\n                    <span class=\"cart-control-minus\"\r\n                          @click=\"handleCount(index, -1)\">-</span>\r\n                    {{item.count}}\r\n                    <span class=\"cart-control-add\"\r\n                          @click=\"handleCount(index, 1)\">+</span>\r\n                </div>\r\n                <div class=\"cart-cost\">\r\n                    ￥ {{productDictList[item.id].cost * item.count}}\r\n                </div>\r\n                <div class=\"cart-delete\">\r\n                    <span class=\"cart-control-delete\"\r\n                          @click=\"handleDelete(index)\">删除</span>\r\n                </div>\r\n            </div>\r\n            <div class=\"cart-empty\" v-if=\"!cartList.length\">购物车为空</div>\r\n        </div>\r\n        <div class=\"cart-promotion\" v-show=\"cartList.length\">\r\n            <span>使用优惠券</span>\r\n            <input type=\"text\" v-model=\"promotionCode\">\r\n            <span class=\"cart-control-promotion\"\r\n                  @click=\"handleCheckCode\">验证</span>\r\n        </div>\r\n        <div class=\"cart-footer\" v-show=\"cartList.length\">\r\n            <div class=\"cart-footer-desc\">\r\n                共计 <span>{{countAll}}</span>\r\n            </div>\r\n            <div class=\"cart-footer-desc\">\r\n                应付总额 <span>{{costAll - promotion}}</span>\r\n                <br>\r\n                <template v-if=\"promotion\">\r\n                    (优惠<span>￥ {{promotion}} </span>)\r\n                </template>\r\n            </div>\r\n            <div class=\"cart-footer-desc\">\r\n                <div class=\"cart-control-order\"\r\n                     @click=\"handleOrder\">现在结算</div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\n    import product_data from './product';\r\n    export default {\r\n        name: \"customer_cart\",\r\n        data(){\r\n            return {\r\n                promotion: 0,\r\n                promotionCode: '',\r\n                productList: product_data\r\n            }\r\n        },\r\n        computed: {\r\n            //购物车数据\r\n            cartList(){\r\n                return this.$store.state.cartList;\r\n            },\r\n            //设置字典对象，方便查询\r\n            productDictList(){\r\n                const dict = {};\r\n                this.productList.forEach(item => {\r\n                    dict[item.id] = item;\r\n                });\r\n                return dict;\r\n            },\r\n            //购物车商品总数\r\n            countAll(){\r\n                let count = 0;\r\n                this.cartList.forEach(item => {\r\n                    count += item.count;\r\n                });\r\n                return count;\r\n            },\r\n            //购物车商品总价\r\n            costAll(){\r\n                let cost = 0;\r\n                this.cartList.forEach(item => {\r\n                    cost += this.productDictList[item.id].cost * item.count;\r\n                });\r\n                return cost;\r\n            }\r\n        },\r\n        methods: {\r\n            //通知Vuex,完成下单\r\n            handleOrder(){\r\n                this.$store.dispatch('buy').then(() => {\r\n                    window.alert('购买成功');\r\n                })\r\n            },\r\n            //验证优惠码，使用ccylovehs代替优惠券字符串\r\n            handleCheckCode(){\r\n                if(this.promotionCode === ''){\r\n                    window.alert('请输入优惠码');\r\n                    return;\r\n                }\r\n                if(this.promotionCode !== 'ccylovehs'){\r\n                    window.alert('优惠码输入错误');\r\n                    return;\r\n                }\r\n                this.promotion = 500;\r\n            },\r\n            //修改购物车数量\r\n            handleCount(index, count){\r\n                //最小值设置1\r\n                if(count < 0 && this.cartList[index].count === 1) return;\r\n                this.$store.commit('editCartCount', {\r\n                    id: this.cartList[index].id,\r\n                    count: count\r\n                });\r\n            },\r\n            //根据index查找商品id进行删除\r\n            handleDelete(index){\r\n                this.$store.commit('deleteCart', this.cartList[index].id);\r\n            }\r\n        }\r\n    }\r\n</script>\r\n\r\n<style scoped>\r\n    .cart{\r\n        margin: 32px;\r\n        background: #fff;\r\n        border: 1px solid #dddee1;\r\n        border-radius: 10px;\r\n    }\r\n    .cart-header-title{\r\n        padding: 16px 32px;\r\n        border-bottom: 1px solid #dddee1;\r\n        border-radius: 10px 10px 0 0;\r\n        background: #f8f8f9;\r\n    }\r\n    .cart-header-main{\r\n        padding: 8px 32px;\r\n        overflow: hidden;\r\n        border-bottom: 1px solid #dddee1;\r\n        background: #eee;\r\n        overflow: hidden;\r\n    }\r\n    .cart-empty{\r\n        text-align: center;\r\n        padding: 32px;\r\n    }\r\n    .cart-header-main div{\r\n        text-align: center;\r\n        float: left;\r\n        font-size: 14px;\r\n    }\r\n    div.cart-info{\r\n        width: 60%;\r\n        text-align: left;\r\n    }\r\n    .cart-price{\r\n        width: 10%;\r\n    }\r\n    .cart-count{\r\n        width: 10%;\r\n    }\r\n    .cart-cost{\r\n        width: 10%;\r\n    }\r\n    .cart-delete {\r\n        width: 10%;\r\n    }\r\n    .cart-content-main{\r\n        padding: 0 32px;\r\n        height: 60px;\r\n        line-height: 60px;\r\n        text-align: center;\r\n        border-bottom: 1px dashed #e9eaec;\r\n        overflow: hidden;\r\n    }\r\n    .cart-content-main div{\r\n        float: left;\r\n    }\r\n    .cart-content-main img{\r\n        width: 40px;\r\n        height: 40px;\r\n        position: relative;\r\n        top: 10px;\r\n    }\r\n    .cart-control-minus,\r\n    .cart-control-add{\r\n        display: inline-block;\r\n        margin: 0 4px;\r\n        width: 24px;\r\n        height: 24px;\r\n        line-height: 22px;\r\n        text-align: center;\r\n        background: #f8f8f9;\r\n        border-radius: 50%;\r\n        box-shadow: 0 1px 1px rgba(0,0,0,.2);\r\n        cursor: pointer;\r\n    }\r\n    .cart-control-delete{\r\n        cursor: pointer;\r\n        color: #2d8cf0;\r\n    }\r\n    .cart-promotion{\r\n        padding: 16px 32px;\r\n    }\r\n    .cart-control-promotion,\r\n    .cart-control-order{\r\n        display: inline-block;\r\n        padding: 8px 32px;\r\n        border-radius: 6px;\r\n        background: #2d8cf0;\r\n        color: #fff;\r\n        cursor: pointer;\r\n    }\r\n    .cart-control-promotion{\r\n        padding: 2px 6px;\r\n        font-size: 12px;\r\n        border-radius: 3px;\r\n    }\r\n    .cart-footer{\r\n        padding: 32px;\r\n        text-align: right;\r\n    }\r\n    .cart-footer-desc{\r\n        display: inline-block;\r\n        padding: 0 16px;\r\n    }\r\n    .cart-footer-desc span{\r\n        color: #f2352e;\r\n        font-size: 20px;\r\n    }\r\n</style>"]},"metadata":{},"sourceType":"module","externalDependencies":[]}